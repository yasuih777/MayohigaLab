[
  {
    "objectID": "qmds/posts/20250202_docker_system/index.html",
    "href": "qmds/posts/20250202_docker_system/index.html",
    "title": "QuartoでWebページを作る際のDocker構成について",
    "section": "",
    "text": "概要\n本ブログでは実行環境をDockerで作成している。コードは↓のGithubリンクから参照できる。\n\nDockerFile\ndokcer-compose\n\n\n\nツール\n\n\n\n\n\n\nWarning\n\n\n\n前もってDocker CLIをインストールしておく。 ※ローカルのターミナル上でdocker、docker composeが動作すれば良い。\n\n\nQuarto websiteを作る上で導入したツールは以下の4つ。\n\nQuarto\n+αでJupyterを動かす場合\n\nR\nPython\nJulia\n\n\nR, Python, Juliaの仮想環境は、公式がサポートしているものを使う。\n\nR: renv\nPython: venv\n\nPoetryを併用して仮想環境を作成する\n\nJulia: Pkg\n\n\n\n\n\n\n\nTip\n\n\n\nデータサイエンス用のプラットフォームであるCondaもQuarto上でサポートされているが、複数の言語を混ぜて使う際に激しめのコンフリクトを起こした。 なので、今回はそれぞれの言語専用の仕組みを使用した。\n\n\n\n\nDockerfileの構成\nベースイメージはubuntuを使用する\nFROM ubuntu:latest\n\n\n\n\n\n\nTip\n\n\n\nPythonやRを一気にビルドするベースイメージとして、jupyter/datascience-notebookがある。 実際に試してみたが、Quartoと併用するときに上手く扱えなかった。 そこで、まっさらなubuntuイメージから愚直にインストールしていく構成をとった。\n\n\nrenv, pyproject.toml, Project.tomlの構成をDocker内にコピーする。\nCOPY . /web_source/\n\n\n\n\n\n\nCaution\n\n\n\nメモリの節約においては仮想環境用ファイル以外はコピーしなくてよいが、面倒なのでやっていない。今後のTODOとする。\n\n\nubuntu側で必要なツールをインストールする。 同時にRとPython(pip)をインストールする。\nRUN apt update \\\n    && cd /web_source \\\n    && apt install -y --no-install-recommends \\\n        curl \\\n        gdebi \\\n        build-essential \\\n        r-base \\\n        pip \\\n    && rm -rf /var/lib/apt/lists/* \\\nRの仮想環境ビルドのため、renvをインストールする。 加えて、仮想環境を再現する。\n# RUN\n   && Rscript -e 'install.packages(\"renv\", repos=\"https://cloud.r-project.org\"); renv::restore(); renv::repair()' \\\nPythonの仮想環境ビルドのため、Poetryをインストールする。 加えて、仮想環境を再現する。\n# RUN\n    && pip install poetry --break-system-packages \\\n    && poetry config --local virtualenvs.in-project true \\\n    && poetry install \\\nJuliaをインストールする。 加えて、仮想環境を再現する。\n# RUN\n    && curl -fsSL https://install.julialang.org | sh -s -- -y \\\n    && /root/.juliaup/bin/julia --project=@. -e 'using Pkg; Pkg.instantiate(); Pkg.precompile()' \\\n\n\n\n\n\n\nTip\n\n\n\nJuliaダウンロード直後はjuliaコマンドが動かなかった(多分PATHの問題)ため、ファイルから実行している。\n\n\nQuartoをインストールする。\n※インストーラーは最後に削除する。\n# RUN\n    && curl -LO https://quarto.org/download/latest/quarto-linux-amd64.deb \\\n    && gdebi --non-interactive quarto-linux-amd64.deb \\\n    && rm -rf quarto-linux-amd64.deb\nこの構成のDockerfileをbuildすることで、必要な環境が全て入ったDocker containerを作成できる。\n\n\ndocker-composeの構成\n特別な工夫はしておらず、Dockerに入ったときに作業中のディレクトリ(web_source)とローカルのディレクトリ構成をリンクさせる設定にしている。\n\n\n\n\n\n\nCaution\n\n\n\nlocalhostをローカル側に移す方法がいまいち分からず、Docker内でのJupyter notebook起動やQuarto previewが出来ない。理解が進んだら修正する。\n\n\n\n\nDocker内のQuarto環境\nquarto checkで確認すると、Python, R, Julia全てが認識できている。\n※Poetryをactivateしてから実行する。\n\n\nCode\n!poetry run quarto check\n\n\nQuarto 1.6.40\n[✓] Checking environment information...\n      Quarto cache location: /root/.cache/quarto\n[✓] Checking versions of quarto binary dependencies...\n      Pandoc version 3.4.0: OK\n      Dart Sass version 1.70.0: OK\n      Deno version 1.46.3: OK\n      Typst version 0.11.0: OK\n[✓] Checking versions of quarto dependencies......OK\n[✓] Checking Quarto installation......OK\n      Version: 1.6.40\n      Path: /opt/quarto/bin\n\n(|) Checking tools....................(/) Checking tools....................[✓] Checking tools....................OK\n      TinyTeX: (not installed)\n      Chromium: (not installed)\n\n[✓] Checking LaTeX....................OK\n      Tex:  (not detected)\n\n(|) Checking basic markdown render....(/) Checking basic markdown render....(-) Checking basic markdown render....(\\) Checking basic markdown render....(|) Checking basic markdown render....(/) Checking basic markdown render....(-) Checking basic markdown render....(\\) Checking basic markdown render....(|) Checking basic markdown render....(/) Checking basic markdown render....[✓] Checking basic markdown render....OK\n\n(|) Checking Python 3 installation....[✓] Checking Python 3 installation....OK\n      Version: 3.12.3\n      Path: /web_source/.venv/bin/python3\n      Jupyter: 5.7.2\n      Kernels: python3, julia-1.11\n\n(|) Checking Jupyter engine render....(/) Checking Jupyter engine render....(-) Checking Jupyter engine render....(\\) Checking Jupyter engine render....(|) Checking Jupyter engine render....(/) Checking Jupyter engine render....(-) Checking Jupyter engine render....(\\) Checking Jupyter engine render....(|) Checking Jupyter engine render....(/) Checking Jupyter engine render....(-) Checking Jupyter engine render....(\\) Checking Jupyter engine render....(|) Checking Jupyter engine render....(/) Checking Jupyter engine render....(-) Checking Jupyter engine render....(\\) Checking Jupyter engine render....(|) Checking Jupyter engine render....(/) Checking Jupyter engine render....(-) Checking Jupyter engine render....(\\) Checking Jupyter engine render....(|) Checking Jupyter engine render....(/) Checking Jupyter engine render....(-) Checking Jupyter engine render....[✓] Checking Jupyter engine render....OK\n\n(|) Checking R installation...........(/) Checking R installation...........(-) Checking R installation...........(\\) Checking R installation...........(|) Checking R installation...........(/) Checking R installation...........(-) Checking R installation...........(\\) Checking R installation...........(|) Checking R installation...........(/) Checking R installation...........(-) Checking R installation...........(\\) Checking R installation...........(|) Checking R installation...........(/) Checking R installation...........[✓] Checking R installation...........OK\n      Version: 4.3.3\n      Path: /usr/lib/R\n      LibPaths:\n        - /web_source/renv/library/R-4.3/x86_64-pc-linux-gnu\n        - /root/.cache/R/renv/sandbox/R-4.3/x86_64-pc-linux-gnu/9a444a72\n      knitr: 1.49\n      rmarkdown: 2.29\n\n(|) Checking Knitr engine render......(/) Checking Knitr engine render......(-) Checking Knitr engine render......(\\) Checking Knitr engine render......(|) Checking Knitr engine render......(/) Checking Knitr engine render......(-) Checking Knitr engine render......(\\) Checking Knitr engine render......(|) Checking Knitr engine render......(/) Checking Knitr engine render......(-) Checking Knitr engine render......(\\) Checking Knitr engine render......(|) Checking Knitr engine render......(/) Checking Knitr engine render......(-) Checking Knitr engine render......(\\) Checking Knitr engine render......(|) Checking Knitr engine render......(/) Checking Knitr engine render......(-) Checking Knitr engine render......(\\) Checking Knitr engine render......(|) Checking Knitr engine render......(/) Checking Knitr engine render......(-) Checking Knitr engine render......(\\) Checking Knitr engine render......[✓] Checking Knitr engine render......OK\n\n\n\n\n\n参考\n\nM2のMacにDockerとDocker Composeをインストールする\n社内のDockerfileのベストプラクティスを公開します\nDocker Composeについてざっくり理解する【概要 / ymlファイル書き方 / コマンド操作】\n\n\n\n\n\nReuseCC BY 4.0"
  },
  {
    "objectID": "qmds/about.html",
    "href": "qmds/about.html",
    "title": "管理者について",
    "section": "",
    "text": "生物統計学と遺伝統計学を頑張りたい人。R&D寄りのデータサイエンティスト。\n\n経歴\n\n熊本県で生まれ育つ\n国立大学の数学科を卒業\n\n解析学(微分積分学)を中心に数学理論を学ぶ\n\n国立大学院の生命科学専攻を修了\n\nWetな手法でエピジェネティクスと初期発生に関する研究を行う\n定量化の方法としては画像解析系の技術を学ぶ\n\n受託分析会社でデータサイエンティストとして勤務\n\nデータ利活用を目的としたコンサルテーションを担当\nBIエンジニアリング, AIエンジニアリング, データ基盤作成, データ分析業を幅広く学ぶ\nプロジェクトリーダーを経験\n\n医療系ベンチャー企業のAIエンジニアとして勤務 ← Now\n\n医療機器に組み込む疾患予測モデルの構築\n社内データ基盤の整備\n臨床研究におけるデータ解析を担当\n\n\n\n\n\nReuseCC BY 4.0"
  },
  {
    "objectID": "qmds/posts.html",
    "href": "qmds/posts.html",
    "title": "記事",
    "section": "",
    "text": "Order By\n       Default\n         \n          Title\n        \n         \n          Date - Oldest\n        \n         \n          Date - Newest\n        \n         \n          Author\n        \n     \n  \n    \n      \n      \n    \n\n\n\n\n\n\n\nQuartoでWebページを作る際のDocker構成について\n\n\n\n\n\n\n\n\n\n2025-02-02\n\n\n\n\n\n\n\n\nNo matching items\n\nReuseCC BY 4.0"
  },
  {
    "objectID": "qmds/index.html",
    "href": "qmds/index.html",
    "title": "ホーム",
    "section": "",
    "text": "管理者が興味があることを書いていきます。\n\n統計理論の検証\n数値シミュレーション\n学習の忘備録\n\nなどなど"
  },
  {
    "objectID": "qmds/index.html#ブログ内のコンテンツ",
    "href": "qmds/index.html#ブログ内のコンテンツ",
    "title": "ホーム",
    "section": "ブログ内のコンテンツ",
    "text": "ブログ内のコンテンツ\n本サイトにおける各エントリの文章や画像などのコンテンツはクリエイティブ・コモンズ・ライセンスを適応します。"
  },
  {
    "objectID": "qmds/index.html#ブログ内サンプルコードのライセンス",
    "href": "qmds/index.html#ブログ内サンプルコードのライセンス",
    "title": "ホーム",
    "section": "ブログ内サンプルコードのライセンス",
    "text": "ブログ内サンプルコードのライセンス\nブログ内で書いているコードに関しては例外的にMIT Licenceを適応します。\n\n\n\n\n\n\nMIT License\n\n\n\n\n\nCopyright 2025\n以下に定める条件に従い、本ソフトウェアおよび関連文書のファイル（以下「ソフトウェア」）の複製を取得するすべての人に対し、ソフトウェアを無制限に扱うことを無償で許可します。これには、ソフトウェアの複製を使用、複写、変更、結合、掲載、頒布、サブライセンス、および/または販売する権利、およびソフトウェアを提供する相手に同じことを許可する権利も無制限に含まれます。\n上記の著作権表示および本許諾表示を、ソフトウェアのすべての複製または重要な部分に記載するものとします。\nソフトウェアは「現状のまま」で、明示であるか暗黙であるかを問わず、何らの保証もなく提供されます。ここでいう保証とは、商品性、特定の目的への適合性、および権利非侵害についての保証も含みますが、それに限定されるものではありません。 作者または著作権者は、契約行為、不法行為、またはそれ以外であろうと、ソフトウェアに起因または関連し、あるいはソフトウェアの使用またはその他の扱いによって生じる一切の請求、損害、その他の義務について何らの責任も負わないものとします。"
  },
  {
    "objectID": "qmds/contact.html",
    "href": "qmds/contact.html",
    "title": "お問い合わせ",
    "section": "",
    "text": "Google Form\n\n読み込んでいます…\n\n\n\n\n\nReuseCC BY 4.0"
  }
]